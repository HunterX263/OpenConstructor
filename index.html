<!DOCTYPE html>
<html>
    <head>
    <!-- Document info -->
    <title>communityconstructor</title>
    <meta charset="UTF-8">
    <!-- Embedded CSS -->
    <style>
        body {
            background-color: #FFFFFF;
        }
        canvas {
            background-color: #FFFFFF;
            border: 1px solid #000000;
        }
    </style>
    <!-- The files making up the constructor, in dependency order -->
    <script type="text/javascript" src="common/vector.js"></script>
    <script type="text/javascript" src="model/mass.js"></script>
    <script type="text/javascript" src="model/spring.js"></script>
    <script type="text/javascript" src="model/model.js"></script>
    <script type="text/javascript" src="controller/physics.js"></script>
    <script type="text/javascript" src="controller/generators.js"></script>
    <script type="text/javascript" src="controller/wave.js"></script>
    <script type="text/javascript" src="ui/ui.js"></script>
    </head>
    <body>
        <!-- The canvas that the constructor will run in -->
        <!-- 720x450 - original SC canvas -->
        <!-- 657x428 - original SC model area -->
        <span style="font-weight: bold; font-family: Verdana"><span style="color:#6ab5ff">community</span>constructor</span>
        <br />
        <canvas
            id="viewport"
            oncontextmenu="return false;"
            width="720" height="450">
        </canvas>

        <!-- Top-level glue code -->
        <script type="text/javascript">
            // default model
            m1 = MASS.create(VECTOR.create(2, 3));
            m2 = MASS.create(VECTOR.create(2, 4.2));
            m3 = MASS.create(VECTOR.create(3, 3.5));
            MODEL.instance.addMass(m1);
            MODEL.instance.addMass(m2);
            MODEL.instance.addMass(m3);
            s1 = SPRING.create(m1, m2, 1, 0.1, 0);
            s2 = SPRING.create(m2, m3, 1, 0.1, Math.PI/2);
            s3 = SPRING.create(m3, m1, 1);
            MODEL.instance.addSpring(s1);
            MODEL.instance.addSpring(s2);
            MODEL.instance.addSpring(s3);

            // set up
            UI.instance.initialize();

            // function to draw one frame
            function _loop(ms)
            {
                // ignore ms timestamp for now and assume vsync at 60 Hz
                let dt = 1/60;
                UI.instance.draw();
                WAVE.instance.tick();
                PHYSICS.instance.tick(dt);
                window.requestAnimationFrame(_loop);
            }

            // start drawing frames
            _loop();
        </script>
    </body>
</html>
